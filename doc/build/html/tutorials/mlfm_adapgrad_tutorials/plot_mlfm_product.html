

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Product Topology of MLFM Models &mdash; pydygp  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Basic MAP Estimation" href="plot_mlfmag.html" />
    <link rel="prev" title="Adaptive Gradient Matching Methods" href="index.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> pydygp
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing PydyGP</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">PydyGP Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../mlfm.html">Multiplicative Latent Force Models Tutorial</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../mlfm.html#model-description">Model Description</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../mlfm.html#model-fitting">Model Fitting</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Adaptive Gradient Matching Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mlfm_sa_tutorials/index.html">Successive Approximations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../mlfm.html#adaptive-gradient-matching">Adaptive Gradient Matching</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Gallery of Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/pydygp.linlatentforcemodels.html">pydygp.linlatentforcemodels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/pydygp.probabilitydistributions.html">pydygp.probabilitydistributions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pydygp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">PydyGP Tutorial</a> &raquo;</li>
        
          <li><a href="../mlfm.html">Multiplicative Latent Force Models Tutorial</a> &raquo;</li>
        
          <li><a href="index.html">Adaptive Gradient Matching Methods</a> &raquo;</li>
        
      <li>Product Topology of MLFM Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorials/mlfm_adapgrad_tutorials/plot_mlfm_product.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-tutorials-mlfm-adapgrad-tutorials-plot-mlfm-product-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="product-topology-of-mlfm-models">
<span id="sphx-glr-tutorials-mlfm-adapgrad-tutorials-plot-mlfm-product-py"></span><h1>Product Topology of MLFM Models<a class="headerlink" href="#product-topology-of-mlfm-models" title="Permalink to this headline">¶</a></h1>
<p>This note demonstrates the use of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">*</span></code> operator
to construct the Cartesian product of MLFM models. The
idea is to combine MLFM with distinct topologies, but a
common set of latent forces.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Still in development – working out the most natural way of calling fit on the
product object. So far all of this note does it demonstrate that the product
operator now gathers the MLFM objects up nicely and provides a nice method
for flattening them back out.</p>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>True 1
True 3
True 6
{&#39;g&#39;: False, &#39;logpsi&#39;: False, &#39;beta_0&#39;: False, &#39;logphi_0&#39;: False, &#39;loggamma_0&#39;: True, &#39;logtau_0&#39;: False, &#39;beta_1&#39;: False, &#39;logphi_1&#39;: False, &#39;loggamma_1&#39;: True, &#39;logtau_1&#39;: False, &#39;beta_2&#39;: False, &#39;logphi_2&#39;: False, &#39;loggamma_2&#39;: True, &#39;logtau_2&#39;: False}
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydygp.liealgebras</span> <span class="kn">import</span> <span class="n">so</span>
<span class="kn">from</span> <span class="nn">pydygp.linlatentforcemodels</span> <span class="kn">import</span> <span class="n">MLFMAdapGrad</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process.kernels</span> <span class="kn">import</span> <span class="n">RBF</span>

<span class="n">mlfm1</span> <span class="o">=</span> <span class="n">MLFMAdapGrad</span><span class="p">(</span><span class="n">so</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lf_kernels</span><span class="o">=</span><span class="p">[</span><span class="n">RBF</span><span class="p">(),</span> <span class="p">])</span>
<span class="n">mlfm2</span> <span class="o">=</span> <span class="n">MLFMAdapGrad</span><span class="p">(</span><span class="n">so</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lf_kernels</span><span class="o">=</span><span class="p">[</span><span class="n">RBF</span><span class="p">(),</span> <span class="p">])</span>
<span class="n">mlfm3</span> <span class="o">=</span> <span class="n">MLFMAdapGrad</span><span class="p">(</span><span class="n">so</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lf_kernels</span><span class="o">=</span><span class="p">[</span><span class="n">RBF</span><span class="p">(),</span> <span class="p">])</span>

<span class="n">mmlfm</span> <span class="o">=</span> <span class="n">mlfm1</span> <span class="o">*</span> <span class="n">mlfm2</span>
<span class="n">mmlfm</span> <span class="o">=</span> <span class="n">mmlfm</span> <span class="o">*</span> <span class="n">mlfm3</span>

<span class="n">mlfms</span> <span class="o">=</span> <span class="n">mmlfm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">mlfms</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s1">&#39;fit&#39;</span><span class="p">),</span> <span class="n">item</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">D</span><span class="p">)</span>


<span class="n">fitopts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;loggamma_is_fixed&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">is_fixed_vars</span> <span class="o">=</span> <span class="n">mmlfm</span><span class="o">.</span><span class="n">_fit_kwarg_parser</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mlfms</span><span class="p">),</span> <span class="o">**</span><span class="n">fitopts</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">is_fixed_vars</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.001 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorials-mlfm-adapgrad-tutorials-plot-mlfm-product-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_mlfm_product.py" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_mlfm_product.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_mlfm_product.ipynb" download=""><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_mlfm_product.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_mlfmag.html" class="btn btn-neutral float-right" title="Basic MAP Estimation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Adaptive Gradient Matching Methods" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Daniel Tait.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>